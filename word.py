import pandas as pd
from indicnlp import common
from indicnlp.morph.unsupervised_morph import UnsupervisedMorphAnalyzer
import re

# Resources का पथ सेट करें
INDIC_RESOURCES_PATH = r"D:\NCERT Sentences\indic_nlp_resources-master"
common.set_resources_path(INDIC_RESOURCES_PATH)

# हिंदी के लिए मॉर्फोलॉजिकल एनालाइजर
analyzer = UnsupervisedMorphAnalyzer('hi')

# स्टॉपवर्ड्स की सूची
stopwords = {"की", "को", "में", "है", "का", "यह", "से", "और", "तो", "ने", "पर", "था", "हो", "ना", "।", "हूँ", "?",
             ",", "हू", "हैं", "मैं", "हू", "।", "ही", "थी", "!", "के", "-", "न" ,"है।", "थे।", "हैं।"}

# Custom root word extraction function
def get_root_word(word):
    suffixes = {
        'ने': 'ना',
        'ते': 'ना',
        'ती': 'ना',
        'ता': 'ना',
        'ो': 'ना',
        'ो-': 'ना',
        'े': 'ा',
        'याँ': '',
        'ीयां': '',
        'ऊँगी': 'ना',
        'ओ': 'ना',
        'ा,': 'ना',
    }
    for suffix, replacement in suffixes.items():
        if word.endswith(suffix):
            return word[:-len(suffix)] + replacement
    return word


# Remove unwanted punctuation characters while preserving Hindi script characters
def clean_text(text):
    # Remove specific unwanted punctuation marks but keep Hindi characters
    cleaned_text = re.sub(r'[^\w\s\u0900-\u097F]', '', text)  # Remove punctuation but keep Hindi characters
    return cleaned_text

# Extract unique words excluding stopwords
def get_ordered_unique_words(text):
    #text = clean_text(text)  # Clean the text first
    words = text.split()
    seen = set()
    ordered_unique_words = []
    for word in words:
        if word not in seen and word not in stopwords:
            seen.add(word)
            ordered_unique_words.append(word)
    return ordered_unique_words

# हिंदी पैराग्राफ
hindi_paragraph = """
बातों-बातों में
सोचिए और बताइए कि बड़ों की बात हमें क्यों माननी चाहिए और अगर हम ऐसा न करें, तो उससे क्या नुकसान
होगा और कठिनाइयों में हिम्मत से काम लेने से क्या होगा?
चिंकी लोमड़ी कूदती हुई आई और पेड़ पर चढ़े बंदरों को देखने लगी। वे एक शाखा से दूसरी शाखा पर उछल-कूद मचा रहे थे। जब बंदरों का खेल खत्म हुआ, तो उनमें से एक लोमड़ी ने पूछा, "अरे, वह अपना ढोल कहाँ है?" "कौन, कौन ढोल ?" बंदरों की समझ में नहीं आया।
'अरे, भाई वही, जो खुद बजता रहता है- ढम्मक-ढम्मक।' 'मगर उसका नाम ढोल कब से हो गया? क्यों नाम बिगाड़ रही हो उसका ?"
एक बंदर ढम्मक-ढम्मक का दोस्त था इसलिए उसने नाराज़ होते हुए कहा ।
"अरे, नाम कहाँ बिगाड़ा? जब भी कोई
अच्छा अवसर होता है तो ढोल बजाया जाता है कि नहीं? सब खूब नाचते-गाते हैं कि नहीं? मेरी बात पर विश्वास न हो तो गाँव जाकर आदमियों से पूछ लो । ”
'वाह जी वाह ! आदमियों से क्यों पूछें। वे तो पहले से ही हमारा नाम बिगाड़ते रहते हैं। हमें कितना बुरा लगता है, मगर क्या करें?" बंदर बोले ।
तभी दूर से आवाज़ सुनाई दी- 
ढम्मक-ढम्मक- ढम्मक-
" लो जी शैतान का नाम लिया और हाज़िर हो गए शैतान!" कहते हुए लोमड़ी ज़ोर से हँसी।
“मगर मैं तो चली। कहीं तुमने उस मोटू पहलवान को बता दिया कि मैंने उसका नाम ढोल रखा है, तो मेरी खैर नहीं। मार-मारकर कचूमर निकाल देगा, सूमो कहीं का । ' जब ढम्मक-ढम्मक पेड़ के पास आया तो उसके दोस्त बंदर ने कहा, “क्यों रे, तू ऐसे क्यों चलता है कि जैसे ढोल बज रहा हो। "
“मेरी मर्ज़ी, मेरी चाल, मैं जानूँ। मालूम नहीं तुम्हें कि फ़ुटबॉल का फ़ॉरेस्ट चैंपियन रह चुका हूँ। एक किक में गोल कर देता था और गज्जू भैया जैसे गोलकीपर भी गोल नहीं रोक पाते थे। " " मगर कोई मैच जीता भी था कभी?"
“मैच क्या मैं अकेला ही जीत जाता, पूरी टीम जीतती - हारती है, लेकिन सच मानो, मेरी वजह से न जाने कितने मैच जीते हैं । " ढम्मक-ढम्मक घमंड से बोला । 
तभी एक बुजुर्ग बंदर ने कहा, “देख बेटा ढम्मक - ढम्मक, तू भी अपने बेटे की तरह है। इसलिए समझा रहा हूँ कि चाल ऐसी हो कि किसी को कानोंकान भी खबर न हो। अपने जंगल में भी एक-दूसरे के कम दुश्मन नहीं हैं।" 'मगर दुश्मन का पता तो आप सब शोर मचाकर दे ही देते हैं न। आप सबके रहते मुझे उनकी परवाह करने की क्या ज़रूरत?" 'अरे, मगर ऐसा भी तो हो सकता है कि हम वहाँ हो ही न, जहाँ दुश्मन हो और हमारा कोई दोस्त उसका शिकार बनने वाला हो। '
ढम्मक-ढम्मक को उनकी बात ठीक लगी। वह बुजुर्ग बंदर से बोला,
“ताऊ जी, क्या करूँ? बचपन से ही ऐसे चल रहा हूँ। किसी ने रोका ही नहीं। अब तो देर हो गई। चाल कैसे बदलूँ?”
“ कोई बात नहीं, आज से ही शुरू कर दो। कोई भी काम शुरू करने के लिए कभी देर नहीं होती। कहते हैं कि जब जागो, तभी सवेरा । " 
“ठीक है ताऊ जी, कोशिश करूँगा । " कहता हुआ ढम्मक-ढम्मक वहाँ से चला गया। थोड़े दिनों तक तो उसने बिना आवाज़ किए चलने की कोशिश की मगर जल्द ही वह बुजुर्ग बंदर की बात भूल गया। एक बार क्या हुआ कि वह घने जंगल के बीच | से जा रहा था। पास में ही एक शेर शिकार की तलाश में था। वह ढम्मक-ढम्मक की चाल से समझ गया कि कोई मोटा-तगड़ा शिकार आस-पास ही है। बस फिर क्या था, शेर फ़ौरन दौड़ पड़ा । तेज़ी से भागते हिरन और चिड़ियों की आवाज़ से ढम्मक-ढम्मक समझ गया कि वहाँ खतरा बेहद नज़दीक है। इसलिए जान बचाने की खातिर वह पास में खड़े मोटे तने वाले एक बरगद के पेड़ पर जा चढ़ा। तभी शेर वहाँ आ पहुँचा। ढम्मक-ढम्मक को पेड़ पर चढ़ा देखकर बोला, 'वाह, तुम्हारी तो चाल ने ही बता दिया था कि तुम आस - पास ही हो। ऐसे क्या बच जाओगे बच्चू? कब तक पेड़ पर चढ़े रहोगे, कभी तो नीचे उतरोगे। मैं भी यहीं बैठा हूँ। " कहते हुए शेर वहीं लेट गया । ढम्मक-ढम्मक याद करने लगा कि अगर वह बंदर ताऊ जी की बात मान लेता, तो कितना अच्छा होता। अब उसे बड़ों की बात न मानने का अंजाम भुगतना पड़ेगा ।
अचानक जैसे उसके मन ने उससे कहा कि वह एक गलती तो बड़ों की बात न मानकर कर चुका है और अब दूसरी गलती हिम्मत हारकर कर रहा है। बस उसने हिम्मत से काम लेना शुरू किया। उसने ऊपर से बहुत-सी डालियाँ तोड़कर शेर के ऊपर फेंकीं, किंतु शेर टस से मस नहीं हुआ। तभी उसकी नज़र पास लगे मधुमक्खियों के छत्तों पर पड़ी । ढम्मक-ढम्मक ने दिमाग से काम लिया। उसने फ़ौरन छत्ते को तोड़ा और शहद खाने लगा। उधर अपना घर टूट जाने के कारण मधुमक्खियाँ आग बबूला हो उठीं। वे ढम्मक-ढम्मक पर टूट पड़ीं पर पूरे शरीर पर घने व लंबे-लंबे बालों के कारण वे उसका क्या बिगाड़तीं ? आखिर ढम्मक-ढम्मक एक भालू जो था!
उधर शेर खर्राटे लेकर मज़े से सो रहा था। मधुमक्खियों को और कुछ नहीं सूझा तो वे शेर पर ही टूट पड़ीं। उनसे बचने के लिए बेचारे शेर को नानी याद आ गई। वह भागता रहा, भागता रहा, मगर मधुमक्खियों ने उसका पीछा नहीं छोड़ा। उधर ढम्मक-ढम्मक पेड़ से नीचे उतरा और धीरे-धीरे सुरक्षित जगह की ओर चलने लगा। 
"""

# Get unique words and their root forms
unique_words = get_ordered_unique_words(hindi_paragraph)
root_words = [get_root_word(word) for word in unique_words]

# Create a Pandas DataFrame
df = pd.DataFrame({"शब्द": unique_words, "मूल शब्द": root_words})

# Display the DataFrame
print(df.to_string(index=False, col_space=15))

# Save the table to a CSV file without the index
#df.to_csv("root_words.csv", index=False, encoding='utf-8-sig')

